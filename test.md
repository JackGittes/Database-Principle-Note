## 数据库原理与应用 第四讲 引言（四）

- 作者：__赵明心__
- 日期：__2019年7月30日__
  
---

## 三（续） 数据库技术的发展历史

### 3.2 从数据库结构看数据库结构的发展

早期，由中央主机和终端构成计算机系统的时候，DBMS集中式管理。随着计算机系统的发展，出现了多个主机的情况，在并行计算机的时候建立数据库的时候，数据库仍然是存储在其中一台主机上，只不过该主机具有多个CPU，能够并行处理数据，这个时期的DBMS在底层存储、查询优化上面做了很多改进。不过从存储的形式上，这个时期的数据库仍然是集中式存储的。在并行数据库的后期，随着局域网的发展，出现了分布式系统。

1970年代中后期，分布式系统出现，当时单台计算机的处理能力比较弱，有时候需要多台处理能力较弱的计算机组成一个计算网络，协调完成一个复杂的任务，使得这个系统达到一个中型机的能力。分布式计算技术的发展使得数据管理也出现了分布式需求，例如一个企业的数据库，由于数据量大、请求多，任何一个单台计算机都无法完成这些请求。这时开始对数据库进行分割，分布存储到网络中的多台计算机上面，对外呈现出一个完整数据库的样子。

联邦式数据库也是在研究分布式情形下的数据库，不过和一般的分布式数据库不太一样，联邦式数据库对异构数据库集成有帮助，每个节点的用户看到的数据库都是不一样的。其实是，近年来出现的移动式数据库，它可以让任何用户在任何地点获取数据库的信息。像现在的小米手机，一般处理主频都在1.几GHZ，现在智能手机和2000年前后的PC机能力已经差不多，能够处理相当复杂的操作，可以在掌上终端上面完成很多数据库的处理过程，从而脱离了传统信息系统的约束。数据存储（缓存）、与企业中心数据库进行同步、处理移动端的数据处理和查询都是移动式数据库关注的内容。

数据库是任何应用的基础和核心，那么还可以按照基于数据库的应用系统的发展来进行分类。在集中式管理的时代，只有主机和哑终端，哑终端只有显示器和键盘，没有处理能力，应用程序都跑在一个主机上。

- 集中式结构：主机-终端结构（Host-Terminal）
- 分布式结构：分布式数据库
- 客户端/服务器结构：出现于80年代初期的非常流行的结构
- 三层或多层体系结构
- 移动计算
- 网格计算/云计算

在局域网中联网的计算机，每台计算机都是地位平等的，每个节点都可能存储了一部分程序，但数据不一定完整，如果自己缺少一部分数据，这个时候就需要其他节点来提供服务。联网计算机之间没有主次之分，地位完全平等。

在客户端/服务器结构中，一般一个处理能力很强的主机来做数据库服务，在它上面只跑DBMS，而应用程序跑在客户机上面，联网计算机有了主次之分，应用程序通过网络对DB服务器进行查询请求，查询结果通过网络返回给客户端，这种结构直到今天仍然被大量使用，尤其是在企业数据管理中，仍然很多。

在多层体系结构中，前端往往就是一个浏览器，例如IE浏览器，用户通过IE提出访问信息系统的请求，IE通过网络（例如Internet）向Web服务器提出请求，而Web服务器判断浏览器的请求是不是一个功能性请求，当Web服务器发现请求是一个J2EE或者ASP应用请求（例如对JAVA对象的访问请求），这个时候Web服务器会将请求转向应用服务器，在应用服务器上面跑的都是一些应用服务，此时应用业务如果需要访问数据，就会像数据服务器提出请求，最后处理结果会以网页页面（例如html）的形式返回给WEB服务器，再返回到浏览器。

<img src="img/Note_04/structure.png" width="65%" alt="多层结构">

和传统的分布式结构、客户端/服务器结构相比，多层体系结构的特点一个是前端简单，只需要一个浏览器。而对于其他结构来说，前端可能需要是一个特定的应用程序，而多层体系结构直接借助互联网，使用网络服务请求来传递数据请求。正常的三层结构系统，应用系统都是跑在应用服务器上面，前端不需要很强，只需要跑一个浏览器就可以。以前Sun公司也有专门做一种计算机，只能用来跑浏览器，这样可以大大降低成本。采用多层结构的时候，客户端不需要安装应用程序，当客户的应用需求发生变化的时候，在BS架构下，只需要替换应用端的程序就可以，不需要替换所有客户端的业务模块。

不过多层结构由于多层转换可能存在效率的问题。采用BS结构还有一个好处是地理范围限制小，使用VPN的时候可以直接在外网对内网资源进行访问，而客户端/服务器模式下面，局域网中的资源无法对外提供服务。

现在客户端/服务器架构和BS结构使用的都很多，很多ERP管理的数据库产品两种使用模式都支持。

<div style="page-break-after: always;"></div>

## 数据库原理与应用 第九讲 关系数据模型

- 作者：**赵明心**
- 日期：**2019年7月31日**

---

### **2.3.5 其他完整性约束**

通过外键实现的引用完整性约束是最重要的完整性约束，还有其他一些完整性约束。
- 域完整性约束（Domain）：一张表中的属性值都需要满足属性值定义的要求，例如整型值不可以插入浮点数
- 实体完整性约束（Entity Integrity Constraint）：一个关系中如果定义了主键的话，则主键属性不能为空。系统会自动进行主键的完整性，强制检查。

<img src="img/Note_09/integrity.png" width="50%" alt="Example">

例子，之后的例子都是在这几张表上做的。水手和船之间是预定的关系，水手有级别、姓名、年龄属性，船有名称、颜色、编号属性，之后有预定表，表明水手和船的预定关系。

这个例子与选课的例子有相似之处，也有一些不同，注意预定表中，水手编号和船编号加在一起不是预定表的主键，因为一个水手可以多次预定一艘船，因此无法通过水手编号和船编号唯一确定预定表中的一项，预定表就是一个全键才可以检索的表。

## 二（4） 关系代数

关系代数中有五个基本操作，任何数据库只要支持这五个基本操作，那我们就称它是关系完备的，任何其他关系操作都可以由五种基本操作导出。
- 基本操作：
  - 选择（Selection，$\sigma$）：从关系中选择行的子集
  - 投影（Projection，$\pi$）：从关系中删除不想要的列
  - 叉乘（Cross-Production，$\times$）：允许我们组合两个关系(拼接两个关系，笛卡尔乘积)
  - 集合差（Set-difference，$-$）：$A-B$，是找到属于关系$A$但不属于关系$B$的元组的操作
  - 并集（Union，$\cup$）：模式相同的关系的元组的合并
- $\{\sigma,\pi,\cup,-,\times\}$是一个完整的操作集，任何其他的关系代数操作都可以从他们衍生出来
- 加性操作：
  - 交集（Intersection）、连接（Join）、除法（division）、外连接（outer join）、外并（outer union）
- 关系代数中的运算结果还是关系，这样操作之间可以组合嵌套。

### **2.4.1 投影**

<img src="img/Note_09/proj.png" width="25%" alt="Projection">

- 删除不在投影表中的属性
- 结果的数据模式精确包含投影表中的域，与输入关系具有相同的名称
- 投影操作必须去重
  - 注意：现实系统一般不做去重操作，除非用户显式指定要去重

投影操作结果关系的模式就是运算符的属性列表中的属性，属性名和类型与输入关系名称相同。（注意模式就是运算结果）。在上面的例子中，向年龄投影的时候会出现重复元组，实际只存在35和55两种，所以需要去掉重复。由于在关系模型中出现两条元组具有完全相同的属性值，那我们认为它表达的是同一个实体，重复的实体是没有意义的，所以需要去掉重复。

从关系代数的理论上去重是必要的，但是数据库产品一般不会主动去重。这是出于用户需求角度考虑的，数据库开发者并不知道用户未来具体有哪些具体要求，例如当我们要计算所有水手的平均年龄的时候，投影到年龄的时候就无法计算平均年龄了，所以不能主动消除重复元组。

### **2.4.2 选择**

<img src="img/Note_09/sel.png" width="35%" alt="Selection">

- 选择操作选择满足选择条件（selection condition）的行（rows）
- 结果是无重复的
- 运算结果的数据模式与输入关系相同
- 结果关系可以做为其他关系代数的输入

选择操作本身在结果中不会产生重复元组，因为选择操作只是在原始输入上做选择，原关系没有重复元组，选择结果也没有重复。选择操作可以继续进行符合。上例中，就是查找级别大于8的水手的姓名和级别，就可以使用以上操作来实现查询。

### **2.4.3 二元操作：并、交、差**

- 所有二元操作都接受两个关系作为输入，两个输入关系必须满足**并兼容**的条件
  - 属性的个数相同
  - 对应属性具有相同的类型
- 结果的模式（schema）如何？

